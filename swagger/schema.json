{
  "produces": [
    "application/json"
  ],
  "consumes": [
    "application/json"
  ],
  "tags": [
    {
      "name": "code",
      "description": "Code injection at run-time."
    },
    {
      "name": "config",
      "description": "Configuration at run-time."
    },
    {
      "name": "status",
      "description": "Status data of the LCP."
    },
    {
      "name": "software",
      "description": "Returns the description of software installed"
    },
    {
      "name": "software",
      "description": "Returns the description of software installed in containers"
    },
    {
      "name": "lcp_relationships",
      "description": "Describes a \"son\" LCP linked in this service chain."
    },
    {
      "name": "lcp_relationships",
      "description": "Describes a \"son\" LCP linked in this service chain."
    },
    {
      "name": "lcp_relationships",
      "description": "Describes a \"son\" LCP linked in this service chain."
    },
    {
      "name": "hardware",
      "description": "Description of a Cloud Infrastructure"
    },
    {
      "name": "Agents",
      "description": "Describes the Agent types and Agent instances."
    },
    {
      "name": "Agents",
      "description": "Describes the Agent types and Agent instances."
    },
    {
      "name": "software",
      "description": "Returns the description of software installed"
    },
    {
      "name": "self",
      "description": "This method does the initial configuration"
    },
    {
      "name": "self",
      "description": "Returns description of self LCP."
    },
    {
      "name": "self",
      "description": "Initial configuration for the LCP"
    },
    {
      "name": "interacts",
      "description": "Describes interactions with other external resources."
    },
    {
      "name": "cb integration",
      "description": "Retrieves data from LCP to the Context Broker"
    }
  ],
  "paths": {
    "/code": {
      "delete": {
        "summary": "Code injection",
        "description": "Inject code at run-time in the local environment.",
        "parameters": [
          {
            "name": "payload",
            "required": true,
            "in": "body",
            "schema": {
              "type": "array",
              "items": {
                "$ref": "#/definitions/Code_Request"
              }
            }
          }
        ],
        "tags": [
          "code"
        ],
        "responses": {
          "200": {
            "description": "Codes inject correctly.",
            "schema": {
              "oneOf": [
                {
                  "type": "array",
                  "items": "Created_Response"
                }
              ]
            }
          },
          "204": {
            "description": "No content to inject codes based on the request.",
            "schema": {
              "$ref": "#/definitions/No_Content_Response"
            }
          },
          "400": {
            "description": "Request not valid.",
            "schema": {
              "$ref": "#/definitions/Bad_Request_Response"
            }
          },
          "401": {
            "description": "Authentication failed.",
            "schema": {
              "$ref": "#/definitions/Unauthorized_Response"
            }
          },
          "406": {
            "description": "Request validation failed.",
            "schema": {
              "$ref": "#/definitions/Not_Acceptable_Response"
            }
          },
          "422": {
            "description": "Not possible to inject one or more codes.",
            "schema": {
              "type": "array",
              "items": {
                "oneOf": [
                  "Created_Response_Schema",
                  "Unprocessable_Entity_Response_Schema"
                ]
              }
            },
            "500": {
              "description": "Server not available to satisfy the request.",
              "schema": "Internal_Server_Error_Response_Schema"
            }
          }
        }
      },
      "post": {
        "summary": "Code injection",
        "description": "Inject code at run-time in the local environment.",
        "parameters": [
          {
            "name": "payload",
            "required": true,
            "in": "body",
            "schema": {
              "type": "array",
              "items": {
                "$ref": "#/definitions/Code_Request"
              }
            }
          }
        ],
        "tags": [
          "code"
        ],
        "responses": {
          "200": {
            "description": "Codes inject correctly.",
            "schema": {
              "oneOf": [
                {
                  "type": "array",
                  "items": "Created_Response"
                }
              ]
            }
          },
          "204": {
            "description": "No content to inject codes based on the request.",
            "schema": {
              "$ref": "#/definitions/No_Content_Response"
            }
          },
          "400": {
            "description": "Request not valid.",
            "schema": {
              "$ref": "#/definitions/Bad_Request_Response"
            }
          },
          "401": {
            "description": "Authentication failed.",
            "schema": {
              "$ref": "#/definitions/Unauthorized_Response"
            }
          },
          "406": {
            "description": "Request validation failed.",
            "schema": {
              "$ref": "#/definitions/Not_Acceptable_Response"
            }
          },
          "422": {
            "description": "Not possible to inject one or more codes.",
            "schema": {
              "type": "array",
              "items": {
                "oneOf": [
                  "Created_Response_Schema",
                  "Unprocessable_Entity_Response_Schema"
                ]
              }
            },
            "500": {
              "description": "Server not available to satisfy the request.",
              "schema": "Internal_Server_Error_Response_Schema"
            }
          }
        }
      },
      "put": {
        "summary": "Update injected code",
        "description": "Update the injected code at run-time in the local environment.",
        "parameters": [
          {
            "name": "payload",
            "required": true,
            "in": "body",
            "schema": {
              "type": "array",
              "items": {
                "$ref": "#/definitions/Code_Request"
              }
            }
          }
        ],
        "tags": [
          "code"
        ],
        "responses": {
          "200": {
            "description": "All injected code correctly updated.",
            "schema": {
              "type": "array",
              "items": {
                "$ref": "#/definitions/Ok_Response"
              }
            }
          },
          "204": {
            "description": "No content to update codes based on the request.",
            "schema": {
              "$ref": "#/definitions/No_Content_Response"
            }
          },
          "304": {
            "description": "Update for one or more codes not necessary.",
            "schema": {
              "type": "array",
              "items": {
                "oneOf": [
                  "Ok_Response_Schema",
                  "Not_Modified_Response"
                ]
              }
            }
          },
          "400": {
            "description": "Request not valid.",
            "schema": {
              "$ref": "#/definitions/Bad_Request_Response"
            }
          },
          "401": {
            "description": "Authentication failed.",
            "schema": {
              "$ref": "#/definitions/Unauthorized_Response"
            }
          },
          "406": {
            "description": "Request validation failed.",
            "schema": {
              "$ref": "#/definitions/Not_Acceptable_Response"
            }
          },
          "415": {
            "description": "Media type not supported.",
            "schema": {
              "$ref": "#/definitions/Unsupported_Media_Type_Response"
            }
          },
          "422": {
            "description": "Not possible to update one or more codes based on the request.",
            "schema": {
              "type": "array",
              "items": {
                "oneOf": [
                  "Ok_Response_Schema",
                  "Not_Modified_Response",
                  "Unprocessable_Entity_Response_Schema"
                ]
              }
            }
          },
          "500": {
            "description": "Server not available to satisfy the request.",
            "schema": {
              "$ref": "#/definitions/Internal_Server_Error_Response"
            }
          }
        }
      }
    },
    "/code/{id}": {
      "delete": {
        "summary": "Code injection",
        "description": "Inject code at run-time in the local environment.",
        "parameters": [
          {
            "name": "payload",
            "required": true,
            "in": "body",
            "schema": {
              "type": "array",
              "items": {
                "$ref": "#/definitions/Code_Request"
              }
            }
          }
        ],
        "tags": [
          "code"
        ],
        "responses": {
          "200": {
            "description": "Codes inject correctly.",
            "schema": {
              "oneOf": [
                {
                  "type": "array",
                  "items": "Created_Response"
                }
              ]
            }
          },
          "204": {
            "description": "No content to inject codes based on the request.",
            "schema": {
              "$ref": "#/definitions/No_Content_Response"
            }
          },
          "400": {
            "description": "Request not valid.",
            "schema": {
              "$ref": "#/definitions/Bad_Request_Response"
            }
          },
          "401": {
            "description": "Authentication failed.",
            "schema": {
              "$ref": "#/definitions/Unauthorized_Response"
            }
          },
          "406": {
            "description": "Request validation failed.",
            "schema": {
              "$ref": "#/definitions/Not_Acceptable_Response"
            }
          },
          "422": {
            "description": "Not possible to inject one or more codes.",
            "schema": {
              "type": "array",
              "items": {
                "oneOf": [
                  "Created_Response_Schema",
                  "Unprocessable_Entity_Response_Schema"
                ]
              }
            },
            "500": {
              "description": "Server not available to satisfy the request.",
              "schema": "Internal_Server_Error_Response_Schema"
            }
          }
        }
      },
      "post": {
        "summary": "Code injection",
        "description": "Inject code at run-time in the local environment.",
        "parameters": [
          {
            "name": "payload",
            "required": true,
            "in": "body",
            "schema": {
              "type": "array",
              "items": {
                "$ref": "#/definitions/Code_Request"
              }
            }
          }
        ],
        "tags": [
          "code"
        ],
        "responses": {
          "200": {
            "description": "Codes inject correctly.",
            "schema": {
              "oneOf": [
                {
                  "type": "array",
                  "items": "Created_Response"
                }
              ]
            }
          },
          "204": {
            "description": "No content to inject codes based on the request.",
            "schema": {
              "$ref": "#/definitions/No_Content_Response"
            }
          },
          "400": {
            "description": "Request not valid.",
            "schema": {
              "$ref": "#/definitions/Bad_Request_Response"
            }
          },
          "401": {
            "description": "Authentication failed.",
            "schema": {
              "$ref": "#/definitions/Unauthorized_Response"
            }
          },
          "406": {
            "description": "Request validation failed.",
            "schema": {
              "$ref": "#/definitions/Not_Acceptable_Response"
            }
          },
          "422": {
            "description": "Not possible to inject one or more codes.",
            "schema": {
              "type": "array",
              "items": {
                "oneOf": [
                  "Created_Response_Schema",
                  "Unprocessable_Entity_Response_Schema"
                ]
              }
            },
            "500": {
              "description": "Server not available to satisfy the request.",
              "schema": "Internal_Server_Error_Response_Schema"
            }
          }
        }
      },
      "put": {
        "summary": "Update injected code",
        "description": "Update the injected code at run-time in the local environment.",
        "parameters": [
          {
            "name": "payload",
            "required": true,
            "in": "body",
            "schema": {
              "type": "array",
              "items": {
                "$ref": "#/definitions/Code_Request"
              }
            }
          }
        ],
        "tags": [
          "code"
        ],
        "responses": {
          "200": {
            "description": "All injected code correctly updated.",
            "schema": {
              "type": "array",
              "items": {
                "$ref": "#/definitions/Ok_Response"
              }
            }
          },
          "204": {
            "description": "No content to update codes based on the request.",
            "schema": {
              "$ref": "#/definitions/No_Content_Response"
            }
          },
          "304": {
            "description": "Update for one or more codes not necessary.",
            "schema": {
              "type": "array",
              "items": {
                "oneOf": [
                  "Ok_Response_Schema",
                  "Not_Modified_Response"
                ]
              }
            }
          },
          "400": {
            "description": "Request not valid.",
            "schema": {
              "$ref": "#/definitions/Bad_Request_Response"
            }
          },
          "401": {
            "description": "Authentication failed.",
            "schema": {
              "$ref": "#/definitions/Unauthorized_Response"
            }
          },
          "406": {
            "description": "Request validation failed.",
            "schema": {
              "$ref": "#/definitions/Not_Acceptable_Response"
            }
          },
          "415": {
            "description": "Media type not supported.",
            "schema": {
              "$ref": "#/definitions/Unsupported_Media_Type_Response"
            }
          },
          "422": {
            "description": "Not possible to update one or more codes based on the request.",
            "schema": {
              "type": "array",
              "items": {
                "oneOf": [
                  "Ok_Response_Schema",
                  "Not_Modified_Response",
                  "Unprocessable_Entity_Response_Schema"
                ]
              }
            }
          },
          "500": {
            "description": "Server not available to satisfy the request.",
            "schema": {
              "$ref": "#/definitions/Internal_Server_Error_Response"
            }
          }
        }
      }
    },
    "/config": {
      "post": {
        "summary": "Configuration update",
        "description": "Apply configuration changes to the local environment.",
        "tags": [
          "config"
        ],
        "parameters": [
          {
            "name": "payload",
            "required": true,
            "in": "body",
            "schema": {
              "type": "array",
              "items": {
                "$ref": "#/definitions/Config_Request"
              }
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Configuration changed correctly.",
            "schema": {
              "oneOf": [
                {
                  "type": "array",
                  "items": "Created_Response"
                }
              ]
            }
          },
          "204": {
            "description": "No content to configure based on the request.",
            "schema": {
              "$ref": "#/definitions/No_Content_Response"
            }
          },
          "400": {
            "description": "Request not valid.",
            "schema": {
              "$ref": "#/definitions/Bad_Request_Response"
            }
          },
          "401": {
            "description": "Authentication failed.",
            "schema": {
              "$ref": "#/definitions/Unauthorized_Response"
            }
          },
          "406": {
            "description": "Request validation failed.",
            "schema": {
              "$ref": "#/definitions/Not_Acceptable_Response"
            }
          },
          "422": {
            "description": "Not possible to change one or more configurations.",
            "schema": {
              "type": "array",
              "items": {
                "oneOf": [
                  "Created_Response_Schema",
                  "Unprocessable_Entity_Response_Schema"
                ]
              }
            }
          },
          "500": {
            "description": "Server not available to satisfy the request.",
            "schema": {
              "$ref": "#/definitions/Internal_Server_Error_Response"
            }
          }
        }
      }
    },
    "/status": {
      "get": {
        "summary": "Status info",
        "description": "Get info about the status of the LCP in the execution environment.",
        "tags": [
          "status"
        ],
        "responses": {
          "200": {
            "description": "Status data of the LCP.",
            "schema": {
              "$ref": "#/definitions/Status_Response"
            }
          },
          "400": {
            "description": "Request not valid.",
            "schema": {
              "$ref": "#/definitions/Bad_Request_Response"
            }
          },
          "401": {
            "description": "Authentication failed.",
            "schema": {
              "$ref": "#/definitions/Unauthorized_Response"
            }
          },
          "406": {
            "description": "Request validation failed.",
            "schema": {
              "$ref": "#/definitions/Not_Acceptable_Response"
            }
          },
          "500": {
            "description": "Server not available to satisfy the request.",
            "schema": {
              "$ref": "#/definitions/Internal_Server_Error_Response"
            }
          }
        }
      },
      "post": {
        "summary": "Status set.",
        "description": "Set the last heartbeat.",
        "tags": [
          "status"
        ],
        "responses": {
          "200": {
            "description": "Heartbeat with CB-Manager correctly executed.",
            "schema": {
              "$ref": "#/definitions/Status_Response"
            }
          },
          "400": {
            "description": "Request not valid.",
            "schema": {
              "$ref": "#/definitions/Bad_Request_Response"
            }
          },
          "401": {
            "description": "Authentication failed.",
            "schema": {
              "$ref": "#/definitions/Unauthorized_Response"
            }
          },
          "406": {
            "description": "Request validation failed.",
            "schema": {
              "$ref": "#/definitions/Not_Acceptable_Response"
            }
          },
          "500": {
            "description": "Server not available to satisfy the request.",
            "schema": {
              "$ref": "#/definitions/Internal_Server_Error_Response"
            }
          }
        }
      }
    },
    "/self/software": {
      "get": {
        "summary": "Get the Software known by this LCP to be installed together with this LCP",
        "description": "Gets the information of the software that this LCP Knows. This data about software could be used\nby an external process to query the CVE database in search for known vulnerabilities after being\nretrieved.\n\nIf no software is known by the LCP it would retrieve an empty array.\n",
        "tags": [
          "software"
        ],
        "responses": {
          "200": {
            "description": "Get the Description of the Software controlled by the LCP",
            "schema": {
              "type": "array",
              "items": {
                "$ref": "#/definitions/SoftwareDefinition"
              }
            }
          },
          "401": {
            "description": "Authentication failed.",
            "schema": {
              "$ref": "#/definitions/Unauthorized_Response"
            }
          },
          "500": {
            "description": "Server not available to satisfy the request.",
            "schema": {
              "$ref": "#/definitions/Internal_Server_Error_Response"
            }
          }
        }
      },
      "post": {
        "summary": "Post the Description and configuration parameters of Security Agents deployed with LCP",
        "description": "Posts the information of the Server software that LCP Knows. This data about software could be used\nby an external process to query the CVE database in search for known vulnerabilities after being\nretrieved from the LCP.\n",
        "parameters": [
          {
            "name": "payload",
            "in": "body",
            "required": true,
            "schema": {
              "type": "array",
              "items": {
                "$ref": "#/definitions/SoftwareDefinition"
              }
            }
          }
        ],
        "tags": [
          "software"
        ],
        "responses": {
          "201": {
            "description": "The Security Function definition has been successfully updated there."
          },
          "401": {
            "description": "Authentication failed.",
            "schema": {
              "$ref": "#/definitions/Unauthorized_Response"
            }
          },
          "406": {
            "description": "Request validation failed.",
            "schema": {
              "$ref": "#/definitions/Not_Acceptable_Response"
            }
          },
          "500": {
            "description": "Server not available to satisfy the request.",
            "schema": {
              "$ref": "#/definitions/Internal_Server_Error_Response"
            }
          }
        }
      }
    },
    "/self/container": {
      "get": {
        "summary": "Get Description of a container running with the LCP",
        "description": "Gets the information of a container (Docker, LXC, etc) running with the LCP and the information of\nthe software that the container is running. This information could help to depict the deployment in\nthe node and the Software information could be useful to query the CVE dtabase in search for known\nvulnerabilities.\n\nIf no container is known by the LCP it would retrieve an empty array.\n",
        "tags": [
          "software"
        ],
        "responses": {
          "200": {
            "description": "Get the Description of the containers and their software running with the LCP",
            "schema": {
              "type": "array",
              "items": {
                "$ref": "#/definitions/ContainerSchema"
              }
            }
          },
          "401": {
            "description": "Authentication failed.",
            "schema": {
              "$ref": "#/definitions/Unauthorized_Response"
            }
          },
          "500": {
            "description": "Server not available to satisfy the request.",
            "schema": {
              "$ref": "#/definitions/Internal_Server_Error_Response"
            }
          }
        }
      },
      "post": {
        "summary": "Post the description of a container and the software installed inside it.",
        "description": "Posts the information of a container (Docker, LXC, etc) running with the LCP and the information of\nthe software that the container is running. This information could help to depict the deployment in\nthe node and the Software information could be useful to query the CVE dtabase in search for known\nvulnerabilities.\n",
        "parameters": [
          {
            "name": "payload",
            "in": "body",
            "required": true,
            "schema": {
              "type": "array",
              "items": {
                "$ref": "#/definitions/ContainerSchema"
              }
            }
          }
        ],
        "tags": [
          "software"
        ],
        "responses": {
          "201": {
            "description": "The Security Function definition has been successfully updated there."
          },
          "401": {
            "description": "Authentication failed.",
            "schema": {
              "$ref": "#/definitions/Unauthorized_Response"
            }
          },
          "406": {
            "description": "Request validation failed.",
            "schema": {
              "$ref": "#/definitions/Not_Acceptable_Response"
            }
          },
          "500": {
            "description": "Server not available to satisfy the request.",
            "schema": {
              "$ref": "#/definitions/Internal_Server_Error_Response"
            }
          }
        }
      }
    },
    "/lcp_son/{id}": {
      "delete": {
        "summary": "Removes an LCP Son given its ID",
        "description": "Removes one Son of the queried LCP given its ID.\n",
        "parameters": [
          {
            "name": "id",
            "requiered": true,
            "in": "path",
            "schema": {
              "type": "string"
            },
            "description": "id of LCP son to be queried",
            "required": true
          }
        ],
        "tags": [
          "lcp_relationships"
        ],
        "responses": {
          "200": {
            "description": "Status data of the LCP.",
            "schema": {
              "$ref": "#/definitions/LCPDescription"
            }
          },
          "400": {
            "description": "Request not valid.",
            "schema": {
              "$ref": "#/definitions/Bad_Request_Response"
            }
          },
          "401": {
            "description": "Authentication failed.",
            "schema": {
              "$ref": "#/definitions/Unauthorized_Response"
            }
          },
          "406": {
            "description": "Request validation failed.",
            "schema": {
              "$ref": "#/definitions/Not_Acceptable_Response"
            }
          },
          "500": {
            "description": "Server not available to satisfy the request.",
            "schema": {
              "$ref": "#/definitions/Internal_Server_Error_Response"
            }
          }
        }
      },
      "get": {
        "summary": "Get a LCP Son given its ID",
        "description": "Gets one Son of the queried LCP given its ID.\n",
        "parameters": [
          {
            "name": "id",
            "requiered": true,
            "in": "path",
            "schema": {
              "type": "string"
            },
            "description": "id of LCP son to be queried",
            "required": true
          }
        ],
        "tags": [
          "lcp_relationships"
        ],
        "responses": {
          "200": {
            "description": "Status data of the LCP.",
            "schema": {
              "$ref": "#/definitions/LCPDescription"
            }
          },
          "400": {
            "description": "Request not valid.",
            "schema": {
              "$ref": "#/definitions/Bad_Request_Response"
            }
          },
          "401": {
            "description": "Authentication failed.",
            "schema": {
              "$ref": "#/definitions/Unauthorized_Response"
            }
          },
          "406": {
            "description": "Request validation failed.",
            "schema": {
              "$ref": "#/definitions/Not_Acceptable_Response"
            }
          },
          "500": {
            "description": "Server not available to satisfy the request.",
            "schema": {
              "$ref": "#/definitions/Internal_Server_Error_Response"
            }
          }
        }
      }
    },
    "/lcp_son": {
      "get": {
        "summary": "Get the LCP Sons (next LCPs in Service Chain) of this LCP",
        "description": "Gets a list of next links in the service chain (LCP sons) to a given execution environment.\nFollowing the LCP Sons the service chain can be quite accurately be depicted.\n",
        "tags": [
          "lcp_relationships"
        ],
        "responses": {
          "200": {
            "description": "List of LCP Sons of the queried LCP.",
            "schema": {
              "type": "array",
              "items": {
                "$ref": "#/definitions/LCPDescription"
              }
            }
          },
          "400": {
            "description": "Request not valid.",
            "schema": {
              "$ref": "#/definitions/Bad_Request_Response"
            }
          },
          "401": {
            "description": "Authentication failed.",
            "schema": {
              "$ref": "#/definitions/Unauthorized_Response"
            }
          },
          "406": {
            "description": "Request validation failed.",
            "schema": {
              "$ref": "#/definitions/Not_Acceptable_Response"
            }
          },
          "500": {
            "description": "Server not available to satisfy the request.",
            "schema": {
              "$ref": "#/definitions/Internal_Server_Error_Response"
            }
          }
        }
      },
      "post": {
        "summary": "Add a new LCP Son to a given LCP, so a service chain can be depicted.",
        "description": "Post a new LCP Son to a given LCP. Once the LCP knows a new children it could post an\n/lcp_parent operation to the children LCP so the children LCP can know which is its\nparent LCP and get data to connect the Context Broker.\n",
        "parameters": [
          {
            "in": "body",
            "required": true,
            "name": "payload",
            "schema": {
              "$ref": "#/definitions/LCPDescription"
            }
          }
        ],
        "tags": [
          "lcp_relationships"
        ],
        "responses": {
          "201": {
            "description": "Created"
          },
          "400": {
            "description": "Request not valid.",
            "schema": {
              "$ref": "#/definitions/Bad_Request_Response"
            }
          },
          "401": {
            "description": "Authentication failed.",
            "schema": {
              "$ref": "#/definitions/Unauthorized_Response"
            }
          },
          "406": {
            "description": "Request validation failed.",
            "schema": {
              "$ref": "#/definitions/Not_Acceptable_Response"
            }
          },
          "500": {
            "description": "Server not available to satisfy the request.",
            "schema": {
              "$ref": "#/definitions/Internal_Server_Error_Response"
            }
          }
        }
      }
    },
    "/lcp_parent": {
      "get": {
        "summary": "Get the LCP parent of a LCP",
        "description": "Gets a list of previous links in the service chain (LCP parents) to a given execution environment.\n",
        "tags": [
          "lcp_relationships"
        ],
        "responses": {
          "200": {
            "description": "List of LCP Sons of the queried LCP.",
            "schema": {
              "type": "array",
              "items": {
                "$ref": "#/definitions/LCPFatherConnection"
              }
            }
          },
          "400": {
            "description": "Request not valid.",
            "schema": {
              "$ref": "#/definitions/Bad_Request_Response"
            }
          },
          "401": {
            "description": "Authentication failed.",
            "schema": {
              "$ref": "#/definitions/Unauthorized_Response"
            }
          },
          "406": {
            "description": "Request validation failed.",
            "schema": {
              "$ref": "#/definitions/Not_Acceptable_Response"
            }
          },
          "500": {
            "description": "Server not available to satisfy the request.",
            "schema": {
              "$ref": "#/definitions/Internal_Server_Error_Response"
            }
          }
        }
      },
      "post": {
        "summary": "Add the LCP parent to a given LCP. Once the LCP Son knows its parent, it can connect it so it can get the Context Broker connection data.",
        "description": "A LCP presents itself as the parent to another LCP. Once the LCP knows its parent, it can\nregister itself using /lcp_son POST to the parent LCP, and getting back the Context Broker\nconnection data.\n",
        "parameters": [
          {
            "in": "body",
            "required": true,
            "name": "payload",
            "schema": {
              "$ref": "#/definitions/LCPFatherConnection"
            }
          }
        ],
        "tags": [
          "lcp_relationships"
        ],
        "responses": {
          "201": {
            "description": "Created"
          },
          "400": {
            "description": "Request not valid.",
            "schema": {
              "$ref": "#/definitions/Bad_Request_Response"
            }
          },
          "401": {
            "description": "Authentication failed.",
            "schema": {
              "$ref": "#/definitions/Unauthorized_Response"
            }
          },
          "406": {
            "description": "Request validation failed.",
            "schema": {
              "$ref": "#/definitions/Not_Acceptable_Response"
            }
          },
          "500": {
            "description": "Server not available to satisfy the request.",
            "schema": {
              "$ref": "#/definitions/Internal_Server_Error_Response"
            }
          }
        }
      }
    },
    "/cloud": {
      "get": {
        "summary": "Get the Description of the Cloud Infrastructure",
        "description": "Gets the information of the cloud Infrastructure where the LCP is installed on. This description of\nthe cloud infrastructure could define as inner objects also things like:\n* Controllers - Used to control the cloud infrastrucutre\n* Compute Nodes - Used to control the Virtual Servers\n\nAlthough this information will only be informative, not specially relevant.\n",
        "tags": [
          "hardware"
        ],
        "responses": {
          "200": {
            "description": "Get the description of the Cloud Infrastructure known by the system",
            "schema": {
              "type": "array",
              "items": {
                "$ref": "#/definitions/CloudSchema"
              }
            }
          },
          "400": {
            "description": "Request not valid.",
            "schema": {
              "$ref": "#/definitions/Bad_Request_Response"
            }
          },
          "401": {
            "description": "Authentication failed.",
            "schema": {
              "$ref": "#/definitions/Unauthorized_Response"
            }
          },
          "406": {
            "description": "Request validation failed.",
            "schema": {
              "$ref": "#/definitions/Not_Acceptable_Response"
            }
          },
          "500": {
            "description": "Server not available to satisfy the request.",
            "schema": {
              "$ref": "#/definitions/Internal_Server_Error_Response"
            }
          }
        }
      },
      "post": {
        "summary": "Post the Description of the Cloud Infrastructure where the LCP is installed on.",
        "description": "Posts the information of the cloud Infrastrucutre where the LCP is installed on.\n",
        "tags": [
          "hardware"
        ],
        "parameters": [
          {
            "name": "payload",
            "in": "body",
            "required": true,
            "schema": {
              "type": "array",
              "items": {
                "$ref": "#/definitions/CloudSchema"
              }
            }
          }
        ],
        "responses": {
          "201": {
            "description": "The Cloud Infrastructure has been successfully updated"
          },
          "400": {
            "description": "Request not valid.",
            "schema": {
              "$ref": "#/definitions/Bad_Request_Response"
            }
          },
          "401": {
            "description": "Authentication failed.",
            "schema": {
              "$ref": "#/definitions/Unauthorized_Response"
            }
          },
          "406": {
            "description": "Request validation failed.",
            "schema": {
              "$ref": "#/definitions/Not_Acceptable_Response"
            }
          },
          "500": {
            "description": "Server not available to satisfy the request.",
            "schema": {
              "$ref": "#/definitions/Internal_Server_Error_Response"
            }
          }
        }
      }
    },
    "/agent/instance": {
      "get": {
        "summary": "Get the Description and configuration parameters of Security Agents deployed with LCP",
        "description": "Gets the information of the SecurityFunctions deployed along with the LCP\n",
        "tags": [
          "Agents"
        ],
        "responses": {
          "200": {
            "description": "Get the Server's configuration infromation from LCP",
            "schema": {
              "$ref": "#/definitions/Agent"
            }
          },
          "400": {
            "description": "Request not valid.",
            "schema": {
              "$ref": "#/definitions/Bad_Request_Response"
            }
          },
          "401": {
            "description": "Authentication failed.",
            "schema": {
              "$ref": "#/definitions/Unauthorized_Response"
            }
          },
          "406": {
            "description": "Request validation failed.",
            "schema": {
              "$ref": "#/definitions/Not_Acceptable_Response"
            }
          },
          "500": {
            "description": "Server not available to satisfy the request.",
            "schema": {
              "$ref": "#/definitions/Internal_Server_Error_Response"
            }
          }
        }
      },
      "post": {
        "summary": "Post the description of an instance of an Agent type previously defined.",
        "description": "Post the description of an instance known its Agent type.\n",
        "parameters": [
          {
            "name": "payload",
            "in": "body",
            "required": true,
            "schema": {
              "type": "array",
              "items": {
                "$ref": "#/definitions/Agent"
              }
            }
          }
        ],
        "tags": [
          "Agents"
        ],
        "responses": {
          "201": {
            "description": "The Agent Instance has been successfully updated there."
          },
          "400": {
            "description": "Request not valid.",
            "schema": {
              "$ref": "#/definitions/Bad_Request_Response"
            }
          },
          "404": {
            "description": "Agent type not previously defined. The agent type should be defined before the Instance.",
            "schema": {
              "$ref": "#/definitions/Not_Found_Response"
            }
          },
          "406": {
            "description": "Request validation failed.",
            "schema": {
              "$ref": "#/definitions/Not_Acceptable_Response"
            }
          },
          "500": {
            "description": "Server not available to satisfy the request.",
            "schema": {
              "$ref": "#/definitions/Internal_Server_Error_Response_Schem"
            }
          }
        }
      }
    },
    "/agent/type": {
      "get": {
        "summary": "Get data relative to the Security Agents defined to be used this LCP",
        "description": "Gets the information of the Agent Types known by this LCP and the data got.\n",
        "tags": [
          "Agents"
        ],
        "responses": {
          "200": {
            "description": "Data relative to the Agents known by this LCP agent",
            "schema": {
              "$ref": "#/definitions/AgentType"
            }
          },
          "400": {
            "description": "Request not valid.",
            "schema": {
              "$ref": "#/definitions/Bad_Request_Response"
            }
          },
          "401": {
            "description": "Authentication failed.",
            "schema": {
              "$ref": "#/definitions/Unauthorized_Response"
            }
          },
          "406": {
            "description": "Request validation failed.",
            "schema": {
              "$ref": "#/definitions/Not_Acceptable_Response"
            }
          },
          "500": {
            "description": "Server not available to satisfy the request.",
            "schema": {
              "$ref": "#/definitions/Internal_Server_Error_Response"
            }
          }
        }
      },
      "post": {
        "summary": "Post an Agent type",
        "description": "Posts the information of an Agent Type that so that an agent can register later to belong this kind\n",
        "parameters": [
          {
            "name": "payload",
            "in": "body",
            "required": true,
            "schema": {
              "type": "array",
              "items": {
                "$ref": "#/definitions/AgentType"
              }
            }
          }
        ],
        "tags": [
          "Agents"
        ],
        "responses": {
          "201": {
            "description": "The software definition has been successfully updated there."
          },
          "401": {
            "description": "Authentication failed.",
            "schema": {
              "$ref": "#/definitions/Unauthorized_Response"
            }
          },
          "406": {
            "description": "Request validation failed.",
            "schema": {
              "$ref": "#/definitions/Not_Acceptable_Response"
            }
          },
          "500": {
            "description": "Server not available to satisfy the request.",
            "schema": {
              "$ref": "#/definitions/Internal_Server_Error_Response_Schem"
            }
          }
        }
      }
    },
    "/self/deployment": {
      "get": {
        "summary": "Get the execution environment deployment for the LCP",
        "description": "Gets the information of the Server where the LCP is deployed.\n",
        "tags": [
          "self"
        ],
        "responses": {
          "200": {
            "description": "Gets the description of the execution environment. The value for the\nenvironment return value could be one of BaremetalServer, LXC Container,\nDocker container, VirtualServer depending on the value for the \"type\"\nof the execution environment.\n",
            "schema": {
              "$ref": "#/definitions/ExecutionEnvironment"
            }
          },
          "400": {
            "description": "Request not valid.",
            "schema": {
              "$ref": "#/definitions/Bad_Request_Response"
            }
          },
          "401": {
            "description": "Authentication failed.",
            "schema": {
              "$ref": "#/definitions/Unauthorized_Response"
            }
          },
          "406": {
            "description": "Request validation failed.",
            "schema": {
              "$ref": "#/definitions/Not_Acceptable_Response"
            }
          },
          "500": {
            "description": "Server not available to satisfy the request.",
            "schema": {
              "$ref": "#/definitions/Internal_Server_Error_Response"
            }
          }
        }
      },
      "post": {
        "summary": "Post the description of the Deployment for the execution environment overriding that calculated",
        "description": "Post the description of the execution environment. The value for the\nenvironment value could be one of BaremetalServer, LXC Container,\nDocker container, VirtualServer depending on the value for the \"type\"\nof the execution environment.\n",
        "tags": [
          "self"
        ],
        "parameters": [
          {
            "in": "body",
            "required": true,
            "name": "payload",
            "schema": {
              "$ref": "#/definitions/ExecutionEnvironment"
            }
          }
        ],
        "responses": {
          "201": {
            "description": "Created"
          },
          "401": {
            "description": "Authentication failed.",
            "schema": {
              "$ref": "#/definitions/Unauthorized_Response"
            }
          },
          "406": {
            "description": "Request validation failed.",
            "schema": {
              "$ref": "#/definitions/Not_Acceptable_Response"
            }
          },
          "500": {
            "description": "Server not available to satisfy the request.",
            "schema": {
              "$ref": "#/definitions/Internal_Server_Error_Response"
            }
          }
        }
      }
    },
    "/self": {
      "get": {
        "summary": "Getst the initial configuration for the LCP.",
        "description": "Gets the initial configuration for the LCP. This includes information about itself\nlike the execution environment ID (lcp.id), the URL where the LCP can be\ncontacted and a human readable name.\n",
        "tags": [
          "self"
        ],
        "responses": {
          "200": {
            "description": "Gets the LCP basic information.",
            "schema": {
              "$ref": "#/definitions/LCPDescription"
            }
          },
          "201": {
            "description": "Created"
          },
          "400": {
            "description": "Request not valid.",
            "schema": {
              "$ref": "#/definitions/Bad_Request_Response"
            }
          },
          "401": {
            "description": "Authentication failed.",
            "schema": {
              "$ref": "#/definitions/Unauthorized_Response"
            }
          },
          "406": {
            "description": "Request validation failed.",
            "schema": {
              "$ref": "#/definitions/Not_Acceptable_Response"
            }
          },
          "500": {
            "description": "Server not available to satisfy the request.",
            "schema": {
              "$ref": "#/definitions/Internal_Server_Error_Response"
            }
          }
        }
      }
    },
    "/self/configuration": {
      "post": {
        "summary": "Post initial configuration for the LCP.",
        "description": "Post initial configuration for the LCP. This includes information about itself\nlike the execution environment ID (lcp.id), the URL where the LCP can be\ncontacted and a human readable name.\n\nThis request will trigger a \"self discovery\" of the deployment of the\nexecution environment (baremental, container, vm), network configuration,\ndisks, cpus, ram, etc\n",
        "parameters": [
          {
            "in": "body",
            "required": true,
            "name": "payload",
            "schema": {
              "$ref": "#/definitions/LCPDescription"
            }
          }
        ],
        "tags": [
          "self"
        ],
        "responses": {
          "201": {
            "description": "Created"
          },
          "400": {
            "description": "Request not valid.",
            "schema": {
              "$ref": "#/definitions/Bad_Request_Response"
            }
          },
          "401": {
            "description": "Authentication failed.",
            "schema": {
              "$ref": "#/definitions/Unauthorized_Response"
            }
          },
          "406": {
            "description": "Request validation failed.",
            "schema": {
              "$ref": "#/definitions/Not_Acceptable_Response"
            }
          },
          "500": {
            "description": "Server not available to satisfy the request.",
            "schema": {
              "$ref": "#/definitions/Internal_Server_Error_Response"
            }
          }
        }
      }
    },
    "/interacts": {
      "get": {
        "summary": "Gets the description of the known elements that a host with a LCP is interacting with.",
        "description": "Gets a description of the components known that the host is working with according to a classical client/server\nparadigm. This includes relationship with other components like publish-subscribe, connection to databases,\nexternal storage drives (NFS, iSCSI, Dropbox), etc.\n",
        "tags": [
          "interacts"
        ],
        "responses": {
          "200": {
            "description": "Get the Server's configuration infromation from LCP",
            "schema": {
              "$ref": "#/definitions/InteractsWithSchema"
            }
          },
          "400": {
            "description": "Request not valid.",
            "schema": {
              "$ref": "#/definitions/Bad_Request_Response"
            }
          },
          "401": {
            "description": "Authentication failed.",
            "schema": {
              "$ref": "#/definitions/Unauthorized_Response"
            }
          },
          "406": {
            "description": "Request validation failed.",
            "schema": {
              "$ref": "#/definitions/Not_Acceptable_Response"
            }
          },
          "500": {
            "description": "Server not available to satisfy the request.",
            "schema": {
              "$ref": "#/definitions/Internal_Server_Error_Response"
            }
          }
        }
      },
      "post": {
        "summary": "Post the description of the elements a host with an LCP is interacting with.",
        "description": "Post a description of the components that the host is working with according to a classical client/server\nparadigm. This includes relationship with other components like publish-subscribe, connection to databases,\nexternal storage drives (NFS, iSCSI, Dropbox), etc.\n",
        "parameters": [
          {
            "in": "body",
            "required": true,
            "name": "payload",
            "schema": {
              "$ref": "#/definitions/InteractsWithSchema"
            }
          }
        ],
        "tags": [
          "interacts"
        ],
        "responses": {
          "201": {
            "description": "The external components which our node is interacting with has been successfully updated."
          },
          "400": {
            "description": "Request not valid.",
            "schema": {
              "$ref": "#/definitions/Bad_Request_Response"
            }
          },
          "401": {
            "description": "Authentication failed.",
            "schema": {
              "$ref": "#/definitions/Unauthorized_Response"
            }
          },
          "406": {
            "description": "Request validation failed.",
            "schema": {
              "$ref": "#/definitions/Not_Acceptable_Response"
            }
          },
          "500": {
            "description": "Server not available to satisfy the request.",
            "schema": {
              "$ref": "#/definitions/Internal_Server_Error_Response_Schem"
            }
          }
        }
      }
    },
    "/poll": {
      "get": {
        "summary": null,
        "description": "Gets all data the LCP has about itself and its environment. Gets all data the LCP has, specially to the Context Broker, so the CB can integrate this data in its knownledge base. The Context Broker will be the one to call this method since there is no pushing information to the CB from the LCP. This is so mainly for security reasons.",
        "tags": [
          "cb integration"
        ],
        "responses": {
          "200": {
            "description": "retrieves all info the LCP has about itself.",
            "schema": {
              "$ref": "#/definitions/PollSchema"
            }
          },
          "404": {
            "description": "Unconfigured LCP. No data to be retrieved this way.",
            "schema": {
              "$ref": "#/definitions/Bad_Request_Response"
            }
          },
          "401": {
            "description": "Authentication failed.",
            "schema": {
              "$ref": "#/definitions/Unauthorized_Response"
            }
          },
          "500": {
            "description": "Server not available to satisfy the request.",
            "schema": {
              "$ref": "#/definitions/Internal_Server_Error_Response"
            }
          }
        }
      }
    }
  },
  "info": {
    "title": "Local Control Plane",
    "version": "1.0.4"
  },
  "swagger": "2.0",
  "definitions": {
    "Code_Request": {
      "type": "object",
      "properties": {
        "id": {
          "type": "string",
          "example": "firewall",
          "description": "Code id."
        },
        "code": {
          "type": "array",
          "description": "Code source",
          "items": {
            "type": "string"
          }
        }
      },
      "required": [
        "code",
        "id"
      ]
    },
    "Exception_Response": {
      "type": "object",
      "properties": {
        "line": {
          "type": "integer",
          "example": 80,
          "description": "Line where the exception is raised."
        },
        "reason": {
          "type": "string",
          "example": "Connection timeout",
          "description": "Exception reason."
        },
        "filename": {
          "type": "string",
          "example": "lib/connection.py",
          "description": "Filename where the exception is raised."
        }
      },
      "required": [
        "filename",
        "line",
        "reason"
      ]
    },
    "No_Content_Response": {
      "type": "object",
      "properties": {
        "status": {
          "default": "No Content"
        },
        "message": {
          "type": "string",
          "example": "Request not valid: two ids provided.",
          "description": "Human readable message that describes the status of the operation."
        },
        "code": {
          "default": 204
        },
        "exception": {
          "description": "Message of the occurred exception.",
          "allOf": [
            {
              "$ref": "#/definitions/Exception_Response"
            }
          ]
        },
        "error": {
          "default": false
        }
      },
      "required": [
        "message"
      ]
    },
    "Bad_Request_Response": {
      "type": "object",
      "properties": {
        "status": {
          "default": "Bad Request"
        },
        "message": {
          "type": "string",
          "example": "Request not valid: two ids provided.",
          "description": "Human readable message that describes the status of the operation."
        },
        "code": {
          "default": 400
        },
        "exception": {
          "description": "Message of the occurred exception.",
          "allOf": [
            {
              "$ref": "#/definitions/Exception_Response"
            }
          ]
        },
        "error": {
          "default": true
        }
      },
      "required": [
        "message"
      ]
    },
    "Unauthorized_Response": {
      "type": "object",
      "properties": {
        "status": {
          "default": "Unauthorized"
        },
        "message": {
          "type": "string",
          "example": "Request not valid: two ids provided.",
          "description": "Human readable message that describes the status of the operation."
        },
        "code": {
          "default": 401
        },
        "exception": {
          "description": "Message of the occurred exception.",
          "allOf": [
            {
              "$ref": "#/definitions/Exception_Response"
            }
          ]
        },
        "error": {
          "default": true
        }
      },
      "required": [
        "message"
      ]
    },
    "Not_Acceptable_Response": {
      "type": "object",
      "properties": {
        "status": {
          "default": "Not Acceptable"
        },
        "message": {
          "type": "string",
          "example": "Request not valid: two ids provided.",
          "description": "Human readable message that describes the status of the operation."
        },
        "code": {
          "default": 406
        },
        "exception": {
          "description": "Message of the occurred exception.",
          "allOf": [
            {
              "$ref": "#/definitions/Exception_Response"
            }
          ]
        },
        "error": {
          "default": true
        }
      },
      "required": [
        "message"
      ]
    },
    "Ok_Response": {
      "type": "object",
      "properties": {
        "status": {
          "default": "OK"
        },
        "message": {
          "type": "string",
          "example": "Request not valid: two ids provided.",
          "description": "Human readable message that describes the status of the operation."
        },
        "code": {
          "default": 200
        },
        "exception": {
          "description": "Message of the occurred exception.",
          "allOf": [
            {
              "$ref": "#/definitions/Exception_Response"
            }
          ]
        },
        "error": {
          "default": false
        }
      },
      "required": [
        "message"
      ]
    },
    "Unsupported_Media_Type_Response": {
      "type": "object",
      "properties": {
        "status": {
          "default": "Unsupported Media Type"
        },
        "message": {
          "type": "string",
          "example": "Request not valid: two ids provided.",
          "description": "Human readable message that describes the status of the operation."
        },
        "code": {
          "default": 415
        },
        "exception": {
          "description": "Message of the occurred exception.",
          "allOf": [
            {
              "$ref": "#/definitions/Exception_Response"
            }
          ]
        },
        "error": {
          "default": true
        }
      },
      "required": [
        "message"
      ]
    },
    "Internal_Server_Error_Response": {
      "type": "object",
      "properties": {
        "status": {
          "default": "Internal Server Error"
        },
        "message": {
          "type": "string",
          "example": "Request not valid: two ids provided.",
          "description": "Human readable message that describes the status of the operation."
        },
        "code": {
          "default": 500
        },
        "exception": {
          "description": "Message of the occurred exception.",
          "allOf": [
            {
              "$ref": "#/definitions/Exception_Response"
            }
          ]
        },
        "error": {
          "default": true
        }
      },
      "required": [
        "message"
      ]
    },
    "Config_Parameter_Request": {
      "type": "object",
      "properties": {
        "path": {
          "type": "array",
          "items": {
            "type": "string",
            "example": "period",
            "description": "Key path."
          }
        },
        "id": {
          "type": "string",
          "example": "period",
          "description": "Id of the parameter."
        },
        "source": {
          "type": "string",
          "example": "firewall.xml",
          "description": "Source filename."
        },
        "schema": {
          "type": "string",
          "enum": [
            "json",
            "properties",
            "xml",
            "yaml"
          ],
          "example": "yaml",
          "description": "Scheme."
        },
        "value": {
          "example": "10s",
          "description": "Parameter new value."
        }
      },
      "required": [
        "id",
        "schema",
        "source",
        "value"
      ]
    },
    "Config_Resource_Request": {
      "type": "object",
      "properties": {
        "path": {
          "type": "string",
          "example": "firewall.xml",
          "description": "File path"
        },
        "content": {
          "type": "string",
          "description": "Resource content."
        },
        "id": {
          "type": "string",
          "example": "filebeat-config",
          "description": "Id of the resource."
        }
      },
      "required": [
        "content",
        "id",
        "path"
      ]
    },
    "Config_Action_Request": {
      "type": "object",
      "properties": {
        "args": {
          "type": "string",
          "example": "-al",
          "description": "Single command argument."
        },
        "id": {
          "type": "string",
          "example": "start",
          "description": "Id of the action."
        },
        "daemon": {
          "type": "boolean",
          "example": true,
          "description": "Execute the command as daemon."
        },
        "output_format": {
          "type": "string",
          "enum": [
            "plain",
            "lines",
            "json"
          ],
          "example": "lines",
          "description": "Format of the output of the command."
        },
        "cmd": {
          "type": "string",
          "description": "Command."
        }
      },
      "required": [
        "cmd",
        "id"
      ]
    },
    "Config_Request": {
      "type": "object",
      "properties": {
        "parameters": {
          "description": "List of parameters.",
          "type": "array",
          "items": {
            "$ref": "#/definitions/Config_Parameter_Request"
          }
        },
        "resources": {
          "description": "List of resources.",
          "type": "array",
          "items": {
            "$ref": "#/definitions/Config_Resource_Request"
          }
        },
        "actions": {
          "description": "List of actions.",
          "type": "array",
          "items": {
            "$ref": "#/definitions/Config_Action_Request"
          }
        }
      }
    },
    "Status_Response": {
      "type": "object",
      "properties": {
        "started": {
          "type": "string",
          "format": "date-time",
          "example": "2019/02/14 15:23:30",
          "description": "Timestamp when the LCP is started"
        },
        "id": {
          "type": "string",
          "example": "apache",
          "description": "ID of the execution environment."
        },
        "last_heartbeat": {
          "type": "string",
          "format": "date-time",
          "example": "2019/02/14 15:23:33",
          "description": "Timestamp of the expiration of the API access configuration."
        }
      },
      "required": [
        "id",
        "last_heartbeat",
        "started"
      ]
    },
    "SoftwareDefinition": {
      "type": "object",
      "properties": {
        "openUDPPorts": {
          "type": "array",
          "example": "[33066]",
          "description": "List of opened UDP Ports",
          "items": {
            "type": "integer"
          }
        },
        "openTCPPorts": {
          "type": "array",
          "example": "[3306]",
          "description": "List of opened TCP Ports",
          "items": {
            "type": "integer"
          }
        },
        "id": {
          "type": "string",
          "example": "a406874b-dea7-4cd1-9d4e-b82a18ec993b",
          "description": "ID of this Software Instance"
        },
        "hasSoftwareConnections": {
          "type": "array",
          "example": [],
          "description": "List of Known connected/related Software",
          "items": {
            "type": "string"
          }
        },
        "vendor": {
          "type": "string",
          "example": "Oracle Coorporation",
          "description": "Name of the Vendor for this software"
        },
        "version": {
          "type": "string",
          "example": "5.8.1",
          "description": "Version of the Piece of Software installed"
        },
        "product": {
          "type": "string",
          "example": "MySQL",
          "description": "Name of this piece of Software instance"
        },
        "type": {
          "type": "string",
          "enum": [
            "SoftwareDefinition"
          ],
          "example": "SoftwareDefinition",
          "description": "Class SoftwareDefinition. The value must be SoftwareDefinition"
        }
      },
      "required": [
        "id",
        "product",
        "type",
        "version"
      ]
    },
    "ContainerSchema": {
      "type": "object",
      "properties": {
        "technology": {
          "type": "string",
          "enum": [
            "lxc",
            "docker",
            "k8s",
            "rkt"
          ],
          "example": "docker",
          "description": "Description of the Container"
        },
        "id": {
          "type": "string",
          "example": "413216e3-169f-4638-830e-ef0607732fde",
          "description": "Id of the Container."
        },
        "type": {
          "type": "string",
          "enum": [
            "ContainerDescription"
          ],
          "example": "ContainerDescription",
          "description": "Class SoftwareDefinition. The value must be ContainerDescription"
        },
        "software": {
          "type": "array",
          "description": "Description of the Software contained in the container",
          "items": {
            "$ref": "#/definitions/SoftwareDefinition"
          }
        }
      },
      "required": [
        "id",
        "software",
        "technology",
        "type"
      ]
    },
    "LCPDescription": {
      "type": "object",
      "properties": {
        "exec_env_type": {
          "type": "string",
          "enum": [
            "LCPDescription"
          ],
          "example": "bare-metal",
          "description": "execution environment type"
        },
        "id": {
          "type": "string",
          "example": "15d41167-79d3-48bf-b8db-9db0c8cc8d54",
          "description": "Unique ID for the Son LCP"
        },
        "description": {
          "type": "string",
          "example": "Testing LCP in localhost",
          "description": "A Human readable description, so it is easy to identify"
        },
        "url": {
          "type": "string",
          "format": "url",
          "example": "http://lcpapi.example.com:4000",
          "description": "URL where the Son LCP Listens"
        },
        "name": {
          "type": "string",
          "example": "lcp-example",
          "description": "Name for the LCP in readable human format"
        },
        "type": {
          "type": "string",
          "enum": [
            "LCPDescription"
          ],
          "example": "LCPDescription",
          "description": "FIWARE's type for this class: LCPDescription"
        }
      },
      "required": [
        "id",
        "name",
        "type",
        "url"
      ]
    },
    "LCPFatherConnection": {
      "type": "object",
      "properties": {
        "url": {
          "type": "string",
          "format": "url",
          "example": "http://lcpapi.example.com:4000",
          "description": "URL where the Son LCP Listens"
        }
      },
      "required": [
        "url"
      ]
    },
    "CloudCompute": {
      "type": "object",
      "properties": {
        "controller_id": {
          "type": "string",
          "example": "3b3041bf-b2fb-47da-8e72-331a67ffd292",
          "description": "ID of the Compute host. The controller could act as compute"
        },
        "type": {
          "type": "string",
          "example": "BaremetalServer",
          "description": "Type of server acting as CloudController"
        }
      },
      "required": [
        "controller_id",
        "type"
      ]
    },
    "CloudController": {
      "type": "object",
      "properties": {
        "controller_id": {
          "type": "string",
          "example": "3b3041bf-b2fb-47da-8e72-331a67ffd292",
          "description": "ID of the Controller host"
        },
        "type": {
          "type": "string",
          "example": "BaremetalServer",
          "description": "Type of server acting as CloudController"
        }
      },
      "required": [
        "controller_id",
        "type"
      ]
    },
    "CloudSchema": {
      "type": "object",
      "properties": {
        "id": {
          "type": "string",
          "example": "f9e6ee65-517a-44da-854d-fdd058fcf2dd",
          "description": "Cloud ID"
        },
        "description": {
          "type": "string",
          "example": "FIWARE Lab Wolfsburg node",
          "description": "Some description of the Cloud"
        },
        "compute_nodes": {
          "type": "array",
          "description": "List of Cloud compute nodes",
          "items": {
            "$ref": "#/definitions/CloudCompute"
          }
        },
        "vendor": {
          "type": "string",
          "example": "Openstack",
          "description": "Cloud Vendor Name"
        },
        "version": {
          "type": "string",
          "example": "queens",
          "description": "Cloud release code name"
        },
        "controllers": {
          "type": "array",
          "description": "List of Cloud Controllers",
          "items": {
            "$ref": "#/definitions/CloudController"
          }
        },
        "name": {
          "type": "string",
          "example": "Wolfsburg-FIWARE-Lab-Cloud",
          "description": "Human readable Cloud name"
        },
        "type": {
          "type": "string",
          "enum": [
            "CloudDescription"
          ],
          "example": "CloudDescription",
          "description": "Must be CloudDescription"
        }
      },
      "required": [
        "id",
        "name",
        "type",
        "vendor"
      ]
    },
    "Agent": {
      "type": "object",
      "properties": {
        "partner": {
          "type": "string",
          "example": "Guard Project",
          "description": "Name of the partner/owner of the Agent"
        },
        "status": {
          "type": "string",
          "enum": [
            "started",
            "stopped",
            "unknown"
          ],
          "example": "started",
          "description": "Update the status the of the agent-instance if the command is executed correctly."
        },
        "id": {
          "type": "string",
          "example": "5db06770-8c64-4693-9724-ff318b02f897",
          "description": "Security Function ID."
        },
        "description": {
          "type": "string",
          "example": "Example agent",
          "description": "Description of the Agent"
        },
        "vendor": {
          "type": "string",
          "example": "FIWARE Foundation e.V.",
          "description": "Name of the vendor providing the security Function"
        },
        "version": {
          "type": "string",
          "example": "1.0.1",
          "description": "Version of the Security Property associated"
        },
        "hasAgentType": {
          "type": "string",
          "example": "PROBE",
          "description": "Id of the Agent Type Associated with this Agent Instance"
        },
        "type": {
          "type": "string",
          "enum": [
            "AgentInstance"
          ],
          "example": "AgentInstance",
          "description": "Data type AgentInstance. Must be 'AgentInstance'"
        },
        "endpoint_url": {
          "type": "string",
          "format": "url",
          "example": "http://example.com:4250/v1/config",
          "description": "URL if some to configure the Parameters."
        }
      },
      "required": [
        "hasAgentType",
        "id",
        "status",
        "type"
      ]
    },
    "AgentResource": {
      "type": "object",
      "properties": {
        "path": {
          "type": "string",
          "example": "/etc/myagent/config.yaml",
          "description": "Path of the Agent config file"
        },
        "description": {
          "type": "string",
          "example": "This is the config file for an agent",
          "description": "Description of the Resource"
        },
        "example": {
          "type": "string",
          "example": "points to an example config file",
          "description": "Config file example"
        }
      },
      "required": [
        "path"
      ]
    },
    "AgentParameter": {
      "type": "object",
      "properties": {
        "path": {
          "type": "string",
          "example": "HeartbeatTime",
          "description": "Name of the Parameter"
        },
        "list": {
          "type": "boolean",
          "example": "true",
          "description": "Marks whether a parameter is list or not"
        },
        "description": {
          "type": "string",
          "example": "Time between Heartbeats",
          "description": "Some description explaining the parameter"
        },
        "type": {
          "type": "string",
          "example": "integer",
          "description": "Type of the Parameter: Int, Number, String..."
        }
      },
      "required": [
        "path",
        "type"
      ]
    },
    "AgentActionSchema": {
      "type": "object",
      "properties": {
        "status": {
          "type": "string",
          "enum": [
            "started",
            "stopped",
            "unknown"
          ],
          "example": "started",
          "description": "Update the status the of the agent-instance according to cmd condition"
        },
        "id": {
          "type": "string",
          "example": "start",
          "description": "Action name"
        },
        "cmd": {
          "type": "string",
          "example": "service filebeat start",
          "description": "Action command."
        }
      },
      "required": [
        "cmd",
        "id"
      ]
    },
    "AgentType": {
      "type": "object",
      "properties": {
        "partner": {
          "type": "string",
          "example": "guard-partner",
          "description": "Name of the Partner who created the resource"
        },
        "resources": {
          "type": "array",
          "description": "List of agents Resources that could be used",
          "items": {
            "$ref": "#/definitions/AgentResource"
          }
        },
        "jsonSchema": {
          "type": "string",
          "example": "https://json-schema.org/draft/2020-12/schema",
          "description": "Pointer for the json describing the data from this kind of agents"
        },
        "id": {
          "type": "string",
          "example": "5db06770-8c64-4693-9724-ff318b02f897",
          "description": "Agent Type ID."
        },
        "description": {
          "type": "string",
          "example": "Example agent",
          "description": "Description of the Agent type"
        },
        "source": {
          "type": "string",
          "example": "/etc/example_agent/config.yaml",
          "description": "The config file where parameters are configured"
        },
        "parameters": {
          "type": "array",
          "description": "List of configuration parameters used",
          "items": {
            "$ref": "#/definitions/AgentParameter"
          }
        },
        "schema": {
          "type": "string",
          "example": "yaml",
          "description": "Type of configuration file (json, yaml, etc.)"
        },
        "type": {
          "type": "string",
          "enum": [
            "AgentType"
          ],
          "example": "AgentType",
          "description": "Data type AgentType. Must be 'AgentType'"
        },
        "actions": {
          "type": "array",
          "description": "List of actions and expected result fro this agent",
          "items": {
            "$ref": "#/definitions/AgentActionSchema"
          }
        }
      },
      "required": [
        "actions",
        "id",
        "partner",
        "schema",
        "source",
        "type"
      ]
    },
    "ExecutionEnvironment": {
      "type": "object",
      "properties": {
        "id": {
          "type": "string",
          "example": "bc2e2eff-fda1-45be-b7f1-93485b756470",
          "description": "This execution environment ID."
        },
        "executionType": {
          "type": "string",
          "enum": [
            "bare-metal",
            "contailer-lxc",
            "vm",
            "container-k8s",
            "container-docker",
            "cloud",
            "mobile",
            "gateway",
            "application"
          ],
          "example": "bare-metal",
          "description": "Type of Exec. Env. Deployment"
        },
        "type": {
          "type": "string",
          "enum": [
            "ExecutionEnvironment"
          ],
          "example": "ExecutionEnvironment",
          "description": "Class ExecutionEnvironment. The value must be ExecutionEnvironment"
        },
        "environment": {
          "type": "object",
          "description": "Definition of environment hardware. Can be one of the types LXCContainer, DockerContainer, VirtualServer, BaremetalServer"
        }
      },
      "required": [
        "environment",
        "executionType",
        "id",
        "type"
      ]
    },
    "ExternalStorageSchema": {
      "type": "object",
      "properties": {
        "id": {
          "type": "string",
          "example": "a406874b-dea7-4cd1-9d4e-b82a18ec993b",
          "description": "ID of this external Storage type"
        },
        "description": {
          "type": "string",
          "example": "remote nfs drive",
          "description": "High level description for this remote storage drive"
        },
        "url": {
          "type": "string",
          "example": "nfs://192.168.10.245:2049/data",
          "description": "URL for this remote resource"
        },
        "storageType": {
          "type": "string",
          "example": "NFS",
          "enum": [
            "S3",
            "NFS",
            "iSCSI",
            "Swift",
            "CEPH",
            "GlusterFS",
            "SSH-FS"
          ],
          "description": "Type of storage type."
        },
        "type": {
          "type": "string",
          "enum": [
            "ExternalStorage"
          ],
          "example": "ExternalStorage",
          "description": "Type of the document. It must be External Storage"
        }
      },
      "required": [
        "id",
        "storageType",
        "type",
        "url"
      ]
    },
    "InteractsWithSchema": {
      "type": "object",
      "properties": {
        "softwareArtifacts": {
          "type": "array",
          "description": "Software artifacts interacting with this LCP",
          "items": {
            "$ref": "#/definitions/SoftwareDefinition"
          }
        },
        "externalStorage": {
          "type": "array",
          "description": "External storage devices description",
          "items": {
            "$ref": "#/definitions/ExternalStorageSchema"
          }
        }
      }
    },
    "LCPConnection": {
      "type": "object",
      "properties": {}
    },
    "LCPContextBrokerDefinition": {
      "type": "object",
      "properties": {
        "type_id": {
          "type": "string",
          "enum": [
            "bare-metal",
            "contailer-lxc",
            "vm",
            "container-k8s",
            "container-docker",
            "cloud",
            "mobile",
            "gateway",
            "application"
          ],
          "example": "bare-metal",
          "description": "Type of execution environment"
        },
        "enabled": {
          "type": "boolean",
          "example": true,
          "description": "Describes if the LCP is enabled or not"
        },
        "id": {
          "type": "string",
          "example": "15d41167-79d3-48bf-b8db-9db0c8cc8d54",
          "description": "Unique ID for the Son LCP"
        },
        "description": {
          "type": "string",
          "example": "Testing LCP in localhost",
          "description": "A Human readable description, so it is easy to identify"
        },
        "lcp": {
          "$ref": "#/definitions/LCPConnection"
        },
        "hasSons": {
          "type": "array",
          "example": [
            "lpc:son:id:1",
            "lcp:son:id:2"
          ],
          "items": {
            "type": "string"
          }
        },
        "hostname": {
          "type": "string",
          "example": "localhost",
          "description": "Hostname of the Host where the LCP can be contacted. If a proxy is behind the LCP, the value should be the proxy host"
        }
      },
      "required": [
        "enabled",
        "hostname",
        "id",
        "lcp",
        "type_id"
      ]
    },
    "NetworkInterface": {
      "type": "object",
      "properties": {
        "state": {
          "type": "string",
          "example": "UP",
          "description": "Network Interface state in the OS"
        },
        "mtu": {
          "type": "integer",
          "example": "1500",
          "description": "Network Interface MTU value"
        },
        "MacAddress": {
          "type": "string",
          "pattern": "^([0-9a-fA-F]{2}:){5}[0-9a-fA-F]{2}$",
          "example": "a2:bc:14:43:ff:43",
          "description": "Network Interface's Mac Address"
        },
        "id": {
          "type": "string",
          "example": "d450f1ce-95a1-4c3d-9e01-6e37f3d0c584",
          "description": "Network Card UUID."
        },
        "deviceType": {
          "type": "string",
          "example": "ethernet",
          "description": "Type of Network device"
        },
        "name": {
          "type": "string",
          "example": "enx503eaaddcbeb",
          "description": "Network interface Name in the OS"
        },
        "IPv4Addresses": {
          "type": "array",
          "description": "List of CIDR for IPv4 values",
          "items": {
            "type": "string",
            "pattern": "^((25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)(/(3[0-2]|[0-2][0-9]|[0-9]))?$"
          }
        },
        "IPv6Addresses": {
          "type": "array",
          "description": "List of CIDR for IPv6 values",
          "items": {
            "type": "string",
            "pattern": "^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))/(12[0-8]|1[01][0-9]|[1-9][0-9]|[0-9])$"
          }
        }
      },
      "required": [
        "id",
        "mtu",
        "name",
        "state"
      ]
    },
    "DiskPartition": {
      "type": "object",
      "properties": {
        "name": {
          "type": "string",
          "example": "nveme0n1p6",
          "description": "Partition name in the OS"
        },
        "size": {
          "type": "number",
          "example": "314461424",
          "description": "Partition Size in Kilo Bytes"
        },
        "type": {
          "type": "string",
          "example": "ext4",
          "description": "Partition type or Filesystem"
        }
      },
      "required": [
        "name",
        "size"
      ]
    },
    "Disk": {
      "type": "object",
      "properties": {
        "model": {
          "type": "string",
          "example": "KBG30ZMV512G TOSHIBA",
          "description": "Disk Model/Vendor"
        },
        "id": {
          "type": "string",
          "example": "5db06770-8c64-4693-9724-ff318b02f897",
          "description": "Disk UUID."
        },
        "diskPartitions": {
          "type": "array",
          "items": {
            "description": "Disk Partitions for the Disk",
            "allOf": [
              {
                "$ref": "#/definitions/DiskPartition"
              }
            ]
          }
        },
        "name": {
          "type": "string",
          "example": "nvme0n1",
          "description": "Disk Name in the OS"
        },
        "size": {
          "type": "integer",
          "example": "314461424",
          "description": "Complete Disk Size in Kilo Bytes"
        }
      },
      "required": [
        "id",
        "name",
        "size"
      ]
    },
    "BaremetalServer": {
      "type": "object",
      "properties": {
        "cpus": {
          "type": "integer",
          "example": "8",
          "description": "CPU Cores in the Server"
        },
        "networkInterfaces": {
          "type": "array",
          "description": "List of Network Interfaces in the host",
          "items": {
            "$ref": "#/definitions/NetworkInterface"
          }
        },
        "id": {
          "type": "string",
          "example": "ed5bd35a-7213-47a9-ae6e-76212e62a157",
          "description": "Network Card UUID."
        },
        "operatingSystem": {
          "type": "string",
          "example": "Ubuntu Linux 20.04.2 LTS",
          "description": "Network interface Name in the OS"
        },
        "diskDevices": {
          "type": "array",
          "items": {
            "description": "Disks installed in the Server",
            "allOf": [
              {
                "$ref": "#/definitions/Disk"
              }
            ]
          }
        },
        "ram": {
          "type": "integer",
          "example": "8",
          "description": "RAM installed in the Server in Megabytes"
        },
        "type": {
          "type": "string",
          "enum": [
            "BaremetalServer"
          ],
          "example": "BaremetalServer",
          "description": "Type of the object. It must be BaremetalServer"
        },
        "hostname": {
          "type": "string",
          "example": "corporario.example.com",
          "description": "Network interface Name in the OS"
        }
      },
      "required": [
        "cpus",
        "hostname",
        "id",
        "operatingSystem",
        "ram",
        "type"
      ]
    },
    "PollSchema": {
      "type": "object",
      "properties": {
        "container": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/ContainerSchema"
          }
        },
        "executionEnvironmentType": {
          "type": "string",
          "enum": [
            "bare-metal",
            "contailer-lxc",
            "vm",
            "container-k8s",
            "container-docker",
            "cloud",
            "mobile",
            "gateway",
            "application"
          ],
          "example": "bare-metal",
          "description": "Type of execution environment"
        },
        "lcp": {
          "description": "LCP Description as required by the CB",
          "allOf": [
            {
              "$ref": "#/definitions/LCPContextBrokerDefinition"
            }
          ]
        },
        "lcpSons": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/LCPContextBrokerDefinition"
          }
        },
        "software": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/SoftwareDefinition"
          }
        },
        "lcpParent": {
          "type": "string",
          "format": "url",
          "example": "http://lcpapi.example.com:4000",
          "description": "URL where the parent LCP Listens."
        },
        "executionEnvironment": {
          "description": "One of BaremetalServer, VirtualServer, DockerContainer or LXCContainer schemas",
          "allOf": [
            {
              "$ref": "#/definitions/BaremetalServer"
            }
          ]
        }
      },
      "required": [
        "executionEnvironmentType",
        "lcp",
        "lcpParent"
      ]
    }
  }
}